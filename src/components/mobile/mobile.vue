<template>
    <div class="page container">
      <section class="mobile-svg-container">
          <img class="mobile-bulb bulb" :class="$store.state.pages >= 2.9 ? 'fade-in' : 'fade-out'" src="../../assets/images/icons/mobile_bulb.png" alt="">
          <svg
            xmlns:dc="http://purl.org/dc/elements/1.1/"
            xmlns:cc="http://creativecommons.org/ns#"
            xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
            xmlns:svg="http://www.w3.org/2000/svg"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
            width="100vw"
            height="47.8vw"
            viewBox="0 0 210 297"
            version="1.1"
            id="mobile-svg"
            inkscape:version="0.92.3 (2405546, 2018-03-11)"
            sodipodi:docname="1231232绘图-3.svg">
            <defs
              id="defs884">
              <linearGradient
                id="linearGradient179"
                spreadMethod="pad"
                gradientTransform="matrix(358.06943,0,0,-358.06943,44.891588,-305.98233)"
                gradientUnits="userSpaceOnUse"
                y2="0"
                x2="1"
                y1="0.5"
                x1="0.5">
                <stop
                  id="stop174"
                  offset="0"
                  style="stop-opacity:1;stop-color:#2b8be1" />
                <stop
                  id="stop176"
                  offset="1"
                  style="stop-opacity:1;stop-color:#ffef00" />
              </linearGradient>
            </defs>
            <sodipodi:namedview
              id="base"
              pagecolor="#ffffff"
              bordercolor="#666666"
              borderopacity="1.0"
              inkscape:pageopacity="0.0"
              inkscape:pageshadow="2"
              inkscape:zoom="0.35"
              inkscape:cx="-98.571429"
              inkscape:cy="560"
              inkscape:document-units="mm"
              inkscape:current-layer="layer1"
              showgrid="false"
              inkscape:window-width="1920"
              inkscape:window-height="1001"
              inkscape:window-x="-9"
              inkscape:window-y="-9"
              inkscape:window-maximized="1" />
            <metadata
              id="metadata1775">
              <rdf:RDF>
                <cc:Work
                  rdf:about="">
                  <dc:format>image/svg+xml</dc:format>
                  <dc:type
                    rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                  <dc:title></dc:title>
                </cc:Work>
              </rdf:RDF>
            </metadata>
            <g
              inkscape:label="Layer 1"
              inkscape:groupmode="layer"
              id="layer1">
              <path
                inkscape:connector-curvature="0"
                id="path344"
                style="fill:none;stroke:url(#linearGradient179);stroke-width:5.64444399;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="M -14.2790633,145.339301 -50.479,145.339301 -50.479,50 -210,50 V 50" />
              <path
                inkscape:connector-curvature="0"
                id="path300"
                style="fill:none;stroke:#ffef00;stroke-width:2.82222199;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="m 31.2790633,130.339301 c -3.81847,10.051344 -3.81847,20.102335 0,30.153679 0.98954,2.604558 -1.24671997,5.284258 -3.97898,4.737806 l -23.1203503,-4.62421 c -7.24112,-1.448154 -12.45341,-7.806266 -12.45341,-15.190259 0,-7.384697 5.21229,-13.74281 12.45341,-15.190963 l 23.1203503,-4.624211 c 2.73226003,-0.5461 4.96852,2.1336 3.97898,4.738158 z" />
              <path
                inkscape:connector-curvature="0"
                id="path304"
                style="fill:none;stroke:#ffef00;stroke-width:2.30716658;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="m -7.801817,139.169259 c -1.51589,4.253794 -1.51589,8.507236 0,12.760677 l -8.52734,-2.552347 v -7.656335 z" />
              <path
                inkscape:connector-curvature="0"
                id="path308"
                style="fill:none;stroke:#ffef00;stroke-width:2.30716658;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="M 2.924957,149.82597 V 141.359303" />
              <path
                inkscape:connector-curvature="0"
                id="path312"
                style="fill:none;stroke:#ffef00;stroke-width:2.30716658;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="M 5.749957,149.82597 V 141.359303" />
              <path
                inkscape:connector-curvature="0"
                id="path316"
                style="fill:none;stroke:#ffef00;stroke-width:2.30716658;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="M 8.574957,149.82597 V 141.359303" />
              <path
                inkscape:connector-curvature="0"
                id="path318"
                style="fill:none;stroke:#ffef00;stroke-width:2.9181776;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="m 20.933297,149.825786 h -5.64444 V 141.35912 h 5.64444 z" />
              <path
                inkscape:connector-curvature="0"
                id="path322"
                style="fill:none;stroke:#ffef00;stroke-width:2.82222199;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="m 175.23168,130.162912 c 3.81811,10.051344 3.81811,20.102335 0,30.153678 -0.98954,2.604559 1.24672,5.284259 3.97863,4.737807 l 23.12035,-4.624211 c 7.24147,-1.448154 12.45376,-7.806266 12.45376,-15.190258 0,-7.384697 -5.21229,-13.742811 -12.45376,-15.190964 l -23.12035,-4.624211 c -2.73191,-0.5461 -4.96817,2.1336 -3.97863,4.738159 z" />
              <path
                inkscape:connector-curvature="0"
                id="path326"
                style="fill:none;stroke:#ffef00;stroke-width:2.30716658;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="m 213.31238,139.99287 c 1.51624,4.253794 1.51624,8.507235 0,12.760676 l 8.5277,-2.552346 v -7.656336 z" />
              <path
                inkscape:connector-curvature="0"
                id="path330"
                style="fill:none;stroke:#ffef00;stroke-width:2.30716658;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="M 205.43588,149.64958 V 141.182913" />
              <path
                inkscape:connector-curvature="0"
                id="path334"
                style="fill:none;stroke:#ffef00;stroke-width:2.30716658;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="M 202.26088,149.64958 V 141.182913" />
              <path
                inkscape:connector-curvature="0"
                id="path338"
                style="fill:none;stroke:#ffef00;stroke-width:2.30716658;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="M 199.08588,149.64958 V 141.182913" />
              <path
                inkscape:connector-curvature="0"
                id="path340"
                style="fill:none;stroke:#ffef00;stroke-width:2.9181776;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="m 187.44403,149.649397 h 5.64445 v -8.466666 h -5.64445 z" />
                <path
                inkscape:connector-curvature="0"
                id="path344"
                style="fill:none;stroke:#fcee21;stroke-width:5.64444399;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                d="M 220.79147,146.339301 253.79147,146.339301 253.79147,241.66 430,241.66 V 241.66" />
            </g>
          </svg>
      </section>
      <section class="mobile-info-container">
        <div class="mobile-word-center">
          <div class="mobile-word-bg part-one-bg"></div>
          <div class="info-part-one">
            <div class="major-name">移动</div>
            <span class="major-intro-one">
              我们与各大中小型企业、创业公司保持着紧密的合作，<br>
              国内最早一批手机卡牌类游戏就出自我们之手，并被<br>
              ChinaJoy邀请参会。
            </span>
            <div class="turn-page">
              <img src="../../assets/images/icons/mobile_arrow.png" alt="">
              <span>向下滚动了解更多</span>
            </div>
          </div>
          <div class="mobile-word-bg part-two-bg"></div>
          <div class="info-part-two">
            <span class="major-intro-two">
              智能手机应用开发小组，简称移动组。小组在结构上前<br>
              前后后经历了三次变革，主攻方向从Android应用/游戏<br>
              开发变为Android应用/后台开发再到现在的纯Android<br>
              应用开发。
            </span>
          </div>
        </div>
      </section>
    </div>
</template>

<script>
import pathUtil from '../../../utils/pathAnimate.js';
export default {
  watch: {
    '$store.state.mobile': {
      handler(newValue, oldValue) {
        this.pathAnimate(newValue, oldValue)
      },
      deep: true
    },
    '$store.state.pages': (pages) => {
      let pathList = $('#mobile-svg path');
      pathUtil.correctEndPath(pathList[0], pathList.slice(1, 7), pages, 2.5, 0.4);
      pathUtil.correctStartPath(pathList[13], pathList.slice(7, 13), pages, 3, 0.1);
    }
  },
  methods: {
    pathAnimate(newValue, oldValue) {
      let insidePercent;
      let height = $(window).height();
      let percent = ($(window).scrollTop() % height) / height;   // 计算翻页时候翻过当前页面的百分之几
      let pathList = $('#mobile-svg path');
      if (percent >= 0.5 && percent <= 1) {
        insidePercent = pathUtil.getEndInsidePer(percent, 0.9);
        if (percent < 0.9) {
          // 这条线需要动画是反过来的，这是设计师画的方向总是从灯座发起的
          pathUtil.lineAnimate(pathList[0], insidePercent, true);
        } else {
          pathUtil.socketAnimate(pathList.slice(1, 7), insidePercent, false);
        }
      } else {
        insidePercent = pathUtil.getStartInsidePer(percent, 0.1);
        if (percent < 0.1) {
          pathUtil.socketAnimate(pathList.slice(7, 13), insidePercent, true);
        } else {
          pathUtil.lineAnimate(pathList[13], insidePercent);
        }
      }
    }
  }
}
</script>

<style scoped>
@media only screen and (min-width: 740px) {
  #mobile-svg {
    position: absolute;
    width: 100vw;
    top: 50%;
    transform: translateY(-50%);
  }
  .mobile-bulb {
    position: absolute;
    width: 5.5rem;
    height: 5.5rem;
    top: 50%;
    left: 50%;
    transform: translateX(-51%) translateY(-51.5%);
    /* left: 6.8rem;
    top: 1.9rem; */
  }
  .mobile-word-bg {
    position: absolute;
    z-index: 0;
    background-color: rgba(252, 238, 33, .3);
  }
  .part-one-bg {
    left: 0.64rem;
    bottom: 1.35rem;
    width: 3.5rem;
    height: 2rem;
  }
  .part-two-bg {
    top: 0.55rem;
    right: 0.5rem;
    width: 7rem;
    height: 1.4rem;
  }
  .container {
    background: url(../../assets/images/background/mobile_background.png) center center no-repeat;
    background-size: cover;
  }
  .mobile-svg-container {
    position: absolute;
    width: 100vw;
    height: 100vh;
  }
  .mobile-info-container {
    position: absolute;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100vw;
    height: 100vh;
  }
  .mobile-word-center {
    position: relative;
    width: 13rem;
    height: 8.5rem;
  }
  .info-part-one {
    position: absolute;
    z-index: 1;
    width: 10rem;
    border-left: 0.09rem solid #FFF77F;
    padding-left: 0.48rem;
    bottom: 0;
  }
  .info-part-two {
    position: absolute;
    z-index: 1;
    width: 7.8rem;
    border-left: 0.09rem solid #FFF77F;
    padding-left: 0.48rem;
    right: 0;
    top: 0.3rem;
  }
  .info-part-one::after,
  .info-part-two::after {
    content: "";
    clear: both;
    display: block;
  }
  .major-name {
    position: absolute;
    font-size: 0.72rem;
    color: #fffccc;
    top: -0.66rem;
    left: 0.16rem;
  }
  .major-intro-one {
    margin-top: 0.64rem;
  }
  .major-intro-one, .major-intro-two {
    display: block;
    font-size: 0.32rem;
    color: #e6e3cf;
  }
}
</style>
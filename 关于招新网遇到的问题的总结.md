# 关于招新网遇到的问题的总结

## 主页面遇到的问题及其解决方案（前端）

### 页面的总体问题

**页面基础：**页面的设计是并不是往常的用户随意滚动，而是进行一页一页滚动。所以页面的高度需要实时监控浏览器显示区域的高度。需要用到css的新单位vh和vw。并且去掉页面右边的滚动条（用到overflow-y: hidden;）。这种设计的页面滚动动画效果需要用到jq的animate方法，但是这种方法的缺点是需要用到setInterval进行重复执行（为了兼容）。对页面的开销比较大，在IE和一些手机上效果并不是很好。代替方法是使用velocity.js进行，这个库的动画重复执行动画

**流动效果**：流动效果是参照网站https://serioverify.com/进行的，需要用到svg图，需要设计师给出，通过监听页面滚轮的变化进行动态效果的显示。

**手机端调试**：手机端调试神器eruda.js进行调试

****

### 页面自适应设计

此页面用到rem和媒介查询进行页面自适应。其中媒介查询区分电脑和手机页面，rem进行页面自适应。好处即可以直接将设计稿的宽高的px值除以100作为单位，直接实现自适应，有利于页面的快速开发。需要在head标签内部添加script标签，标签内部添加代码如下：

```JavaScript
function resizeRem() {
        var whdef;
        if (window.innerWidth > 740) {
          whdef = 100 / 1920;  // 屏幕一共分为多少份
        } else {
          whdef = 100 / 1100;  // 手机端
        }
        // 根据设计稿的宽高和屏幕的宽度定义Rem的值
        var wH = window.innerHeight;
        var wW = window.innerWidth;
        var rem = wW * whdef;  // 得出一份的宽度像素
        document.documentElement.style.fontSize = rem + 'px';
      }
      window.onresize = resizeRem;  // 动态调整
      resizeRem();
```

在进行页面的布局的时候，元素的宽高比直接使用设计稿的像素值除以100即可。原理即将屏幕分为19.20份，（每份占有的像素whdef为100除以设计稿的宽度）。然后获取屏幕的宽度，得到每份宽度所对应的屏幕真是像素。监听onresize即可以动态调整。

****

### SVG图的问题

#### 两个页面间svg图如何进行无缝连接

**问题1**：如何实现两份svg进行无缝连接

**解决方案**：将所有的svg图的宽度（需要绝对定位）设为100vw，高度设为与宽度相关的值，本次项目为47.8vw。但是这个vw不能直接用，因为有的浏览器不支持在svg标签属性上添加vw属性，可以通过js定义一个state变量，然后用这个变量代替vw即可兼容。将所有的svg设为绝对定位，并且如果两页是需要相连接的，比如第一页的线连接第二页，那么第一页的svg图需要靠在最下边，第二页需要靠在最上边。

#### svg图的流动

svg图的流动需要用svg标签内部的path路径的strokeDashoffset和strokeDasharray这两个属性，实现方法可以在百度上找到。通过页面的滚动条到达页面顶部进行判断从而进行动画效果。

**问题1：**svg图在edge上会出现残余，没法完全消去

**解决方案**：这个动画效果在ie上会出现残余效果，即无法完全消失，此时需要判断，在线条消失的时候设path的opacity属性设为0，进行IE浏览器的兼容。

**问题2：**页面滚动过快，会出现残余。

**解决方案**：这个是因为监听页面滚动的函数的监听频率不会很高，所以在流动消退或者布满的时候会出现消退不完全或者补满不完全。解决办法是判断是否临近目标，然后直接赋值为目标。

#### Chrome/fireFox内核右上角svg图的渐变效果

因为svg图的动效只有在比较新版本的浏览器上面才会显示，Chrome内核和firefox上面会进行显示。svg图的渐变效果可以在defs标签中进行设置，有径向渐变和线性渐变，这个可以参考网上资料。开发会遇到以下问题。

**问题1**：svg图的渐变动画是整一块进行颜色渐变的，即如果一个方块从黄色到达红色，这一整块方块内部全部区域一起变化并不会有那种从左上到右下的渐变感觉。

**解决方案**：是通过将右上角的圆圈分为3部分，左上、中间、右下，然后分别进行颜色的渐变。由于整个设计是从左上到右下是透明度增加的，所以我们可以将原来的（下面称为A）左上、中间、右下的颜色（rgba）取出来，然后获取下一个颜色（下面称为B）的左上、中间、右下的颜色（rgba）然后左上区域的颜色由A的左上颜色渐变到B的右下的颜色，中间的颜色由A的中间渐变到A的左上，右下的颜色由A的右下渐变到A的中间。定义完全后在进行渐变，直到图标的颜色渐变到完全为B的颜色。

****

### Loading动画的问题

Loading动画的目的无需多说，但是Loading动画的存放位置却需要进行思考。

**解决方案**：loading动画存放在主块的前边，这样在加载的时候会先加载动画，再进行下载js文件，然后监听页面加载完毕，这样可以实现动画的作用。

****

### 如何避免翻页动画连续发生

加锁：加一个变量充当锁。

****

### 实现页面上的元素（比如灯泡）和背景有某种相对位置关系

实现的前提是响应式页面布局，就是前边那个布局方式，其次本次能做到的原因是将一个背景图分成三层：

底层：这个是背景，无需怎么处理；

中间层：黑色部分，设计师需要将缺陷的部分进行补全，前端需要进行绝对定位，并且background-position属性要进行设置；

上层：即内缺层，用绝对定位。

思路即用上层来假装缺陷的部分。

****

